Ext.ns("Ext.manage.emprolemodule");Ext.define("Ext.manage.emprolemodule.employeeList",{extend:"Ext.zhifangux.GridPanel",alias:"widget.employeeList",title:"员工列表",width:878,height:200,objectName:"HREmployee",openFormId:"",defaultLoad:false,defaultWhere:"",sortableColumns:true,initComponent:function(){var me=this;Ext.Loader.setPath("Ext.ux",getRootPath()+"/ui/extjs/ux");me.url=getRootPath()+"/RBACService.svc/RBAC_UDTO_GetHREmployeeByHRDeptID?isPlanish=true&fields=HREmployee_CName,HREmployee_HRDept_CName,HREmployee_HRPosition_CName,HREmployee_UseCode,HREmployee_Id,HREmployee_IsEnabled,HREmployee_HRDept_DispOrder,HREmployee_EName,HREmployee_StandCode,HREmployee_Comment,HREmployee_Shortcode";me.searchArray=["hremployee.CName","hremployee.HRDept.CName","hremployee.UseCode","hremployee.Shortcode"];me.store=me.createStore({fields:["HREmployee_CName","HREmployee_HRDept_CName","HREmployee_HRPosition_CName","HREmployee_UseCode","HREmployee_Id","HREmployee_IsEnabled","HREmployee_HRDept_DispOrder","HREmployee_EName","HREmployee_StandCode","HREmployee_Comment","HREmployee_Shortcode"],url:"RBACService.svc/RBAC_UDTO_GetHREmployeeByHRDeptID?isPlanish=true&fields=HREmployee_CName,HREmployee_HRDept_CName,HREmployee_HRPosition_CName,HREmployee_UseCode,HREmployee_Id,HREmployee_IsEnabled,HREmployee_HRDept_DispOrder,HREmployee_EName,HREmployee_StandCode,HREmployee_Comment,HREmployee_Shortcode",remoteSort:true,sorters:[{property:"HREmployee_HRDept_DispOrder",direction:"ASC"}],PageSize:1e3,hasCountToolbar:true,buffered:false,leadingBufferZone:null});me.defaultColumns=[{text:"名称",dataIndex:"HREmployee_CName",width:84,hideable:true,align:"left"},{text:"直属部门",dataIndex:"HREmployee_HRDept_CName",width:91,hideable:true,align:"left"},{text:"职位",dataIndex:"HREmployee_HRPosition_CName",width:100,hideable:true,align:"left"},{text:"员工代码",dataIndex:"HREmployee_UseCode",width:78,hideable:true,align:"left"},{text:"主键ID",dataIndex:"HREmployee_Id",width:100,sortable:false,hidden:true,hideable:true,align:"left"},{text:"在职",dataIndex:"HREmployee_IsEnabled",xtype:"booleancolumn",trueText:"是",falseText:"否",defaultRenderer:function(value){if(value===undefined){return this.undefinedText}if(!value||value==="false"||value==="0"||value===0){return this.falseText}return this.trueText},width:37,hideable:true,align:"left"},{text:"英文名称",dataIndex:"HREmployee_EName",width:100,sortable:false,hideable:true,align:"left"},{text:"标准代码",dataIndex:"HREmployee_StandCode",width:100,sortable:false,hidden:true,hideable:true,align:"left"},{text:"描述",dataIndex:"HREmployee_Comment",width:110,sortable:false,hideable:true,align:"left"},{text:"快捷码",dataIndex:"HREmployee_Shortcode",width:100,sortable:false,hidden:true,hideable:true,align:"left"}];me.columns=me.createColumns();me.dockedItems=[{itemId:"pagingtoolbar",xtype:"toolbar",dock:"bottom",items:[{xtype:"label",itemId:"count",text:"共0条"}]},{xtype:"toolbar",itemId:"buttonstoolbar",dock:"top",items:[{type:"refresh",itemId:"refresh",text:"更新",iconCls:"build-button-refresh",handler:function(but,e){var com=but.ownerCt.ownerCt;com.load(true)}},{type:"add",itemId:"add",text:"新增",iconCls:"build-button-add",handler:function(but,e){me.fireEvent("addClick")}},{type:"edit",itemId:"edit",text:"修改",iconCls:"build-button-edit",handler:function(but,e){me.fireEvent("editClick")}},{type:"del",itemId:"del",text:"删除",iconCls:"build-button-delete",handler:function(but,e){var records=me.getSelectionModel().getSelection();if(records.length>0){Ext.Msg.confirm("提示","确定要删除吗？",function(button){var createFunction=function(id){var f=function(){var rowIndex=me.store.find("HREmployee_Id",id);me.deleteIndex=rowIndex;me.load(true);me.fireEvent("delClick")};return f};if(button=="yes"){for(var i in records){var id=records[i].get("HREmployee_Id");var callback=createFunction(id);me.deleteInfo(id,callback)}}})}else{alertInfo("请选择数据进行操作！")}}},"->",{xtype:"textfield",itemId:"searchText",width:160,emptyText:"名称/直属部门/员工代码/快捷码",listeners:{render:function(input){new Ext.KeyMap(input.getEl(),[{key:Ext.EventObject.ENTER,fn:function(){me.search()}}])}}},{xtype:"button",text:"查询",iconCls:"search-img-16 ",tooltip:"按照名称/直属部门/员工代码/快捷码进行查询",handler:function(button){me.search()}}]}];me.deleteInfo=function(id,callback){var url=getRootPath()+"/RBACService.svc/RBAC_UDTO_DelHREmployee?id="+id;var c=function(text){var result=Ext.JSON.decode(text);if(result.success){if(Ext.typeOf(callback)=="function"){callback()}}else{alertError(result.ErrorInfo)}};getToServer(url,c)};me.addEvents("addClick");me.addEvents("afterOpenAddWin");me.addEvents("delClick");this.callParent(arguments)}});
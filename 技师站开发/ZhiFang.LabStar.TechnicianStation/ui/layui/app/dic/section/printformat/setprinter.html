<!DOCTYPE html>
<html>
 <head> 
  <meta charset="utf-8" /> 
  <title>layui</title> 
  <meta name="renderer" content="webkit" /> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
   <script type="text/javascript">
    //加载版本号文件
    document.write("<script type='text/javascript' src='../../../../config/version.js?t=" + new Date().getTime() + "'><\/script>");
  </script> 
 </head> 
 <body> 
  <div class="layui-card"> 
   <div class="layui-card-body"> 
    <div class="layui-form" id="LBPhrase" lay-filter="LBPhrase"> 
     <div class="layui-form-item"> 
      <div class="layui-col-xs10"> 
       <label class="layui-form-label" style="width: 50px;">打印机</label> 
       <div class="layui-input-block" style="margin-left:80px;"> 
        <select name="LBSectionPrint_DefPrinter" autocomplete="off" id="LBSectionPrint_DefPrinter" lay-filter="LBSectionPrint_DefPrinter"> <option value="">请选择</option><option value="站点默认打印机">站点默认打印机</option> </select> 
       </div> 
      </div> 
      <div class="layui-col-xs2"> 
       <button class="layui-btn layui-btn-xs" lay-submit="" id="save" lay-filter="save"><i class="iconfont"></i>&nbsp;确定</button> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
   </body>
    <script src="http://localhost:8000/CLodopfuncs.js"></script> 
    <script src="http://localhost:18000/CLodopfuncs.js"></script> 
    <script type="text/javascript">
		UIVersion.loadLayui();
		UIVersion.getCSS('../../../../css/layui.form.sm.all.css');
    </script>
    <script type="text/javascript">
		layui.extend({
			clodopprint:'../src/clodop/clodopprint'
		}).use(['form','clodopprint','uxutil'],function(){
				var $ = layui.$,
				clodopprint = layui.clodopprint,
				uxutil = layui.uxutil,
				form = layui.form;
			
            
			//获取本地电脑可选的打印机(驱动),打印机
			function iniPrinterList() {
				var list = clodopprint.getPrinterList();
				var tempAjax = "<option value=''>请选择</option><option value='站点默认打印机'>站点默认打印机</option>";
		        if(!list)return;
		        for (var i = 0; i < list.length; i++) {
		            tempAjax += "<option value='" + list[i][1] + "'>" + list[i][1] + "</option>";
		        }
		        $("#LBSectionPrint_DefPrinter").empty();
		        $("#LBSectionPrint_DefPrinter").append(tempAjax);
				form.render('select');//需要渲染一下;
			}
			
		    function init(){
		    	iniPrinterList();
		    	//外部参数
	            var PARAMS = uxutil.params.get(true);
	            
	            document.getElementById('LBSectionPrint_DefPrinter').value = PARAMS.PRINT;
	            form.render('select');
	             //确定
				form.on('submit(save)',function(data){
					parent.layer.closeAll('iframe');
				    parent.afterDefPrinterUpdate(document.getElementById('LBSectionPrint_DefPrinter').value);
				});
		    }
		    init();
		});
	</script>  

</html>
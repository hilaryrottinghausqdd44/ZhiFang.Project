Ext.ns("Ext.manage.emprolemodule");Ext.define("Ext.manage.emprolemodule.employeeForm",{extend:"Ext.zhifangux.FormPanel",alias:"widget.employeeForm",title:"员工基本信息",defaultTitle:"员工基本信息",width:434,height:367,objectName:"HREmployee",addUrl:"RBACService.svc/RBAC_UDTO_AddHREmployee",editUrl:"RBACService.svc/RBAC_UDTO_UpdateHREmployeeByField",selectUrl:"RBACService.svc/RBAC_UDTO_SearchHREmployeeById",type:"show",bgFielName:"",initComponent:function(){var me=this;if(me.type=="show"){me.height-=25}me.fields="HREmployee_NameL,HREmployee_NameF,HREmployee_CName,HREmployee_PinYinZiTou,HREmployee_EName,HREmployee_IdNumber,HREmployee_Shortcode,HREmployee_BSex_Id,HREmployee_Birthday,HREmployee_UseCode,HREmployee_HRDept_Id,HREmployee_HRPosition_Id,HREmployee_JobDuty,HREmployee_IsEnabled,HREmployee_MobileTel,HREmployee_OfficeTel,HREmployee_ExtTel,HREmployee_Email,HREmployee_Comment,HREmployee_LabID,HREmployee_Id,HREmployee_HRDept_DataTimeStamp,HREmployee_HRPosition_DataTimeStamp,HREmployee_BSex_DataTimeStamp,HREmployee_DataTimeStamp";me.items=[{xtype:"textfield",type:"textfield",itemId:"HREmployee_NameL",name:"HREmployee_NameL",labelWidth:60,height:22,x:5,y:12,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"姓",labelAlign:"right",sortNum:1,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_NameF",name:"HREmployee_NameF",labelWidth:60,height:22,x:5,y:38,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"名",labelAlign:"right",sortNum:2,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_CName",name:"HREmployee_CName",labelWidth:60,height:22,x:5,y:64,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"名称",labelAlign:"right",sortNum:3,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_PinYinZiTou",name:"HREmployee_PinYinZiTou",labelWidth:60,height:22,x:5,y:90,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"拼音字头",labelAlign:"right",sortNum:4,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_EName",name:"HREmployee_EName",labelWidth:60,height:22,x:5,y:116,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"英文名称",labelAlign:"right",sortNum:5,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_IdNumber",name:"HREmployee_IdNumber",labelWidth:60,height:22,x:5,y:142,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"身份证号",labelAlign:"right",sortNum:26,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_Shortcode",name:"HREmployee_Shortcode",labelWidth:60,height:22,x:4,y:167,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"快捷码",labelAlign:"right",sortNum:6,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"combobox",editable:true,typeAhead:true,queryMode:"local",displayField:"BSex_Name",valueField:"BSex_Id",DataTimeStampField:"HREmployee_BSex_DataTimeStamp",store:new Ext.data.Store({fields:["BSex_Name","BSex_Id","BSex_DataTimeStamp"],pageSize:1e3,proxy:{type:"ajax",async:false,url:getRootPath()+"/SingleTableService.svc/ST_UDTO_SearchBSexByHQL?isPlanish=true&fields=BSex_Name,BSex_Id,BSex_DataTimeStamp",reader:{type:"json",root:"list"},extractResponseData:me.changeStoreData},autoLoad:false}),type:"combobox",itemId:"HREmployee_BSex_Id",name:"HREmployee_BSex_Id",labelWidth:60,height:22,x:5,y:195,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"性别",labelAlign:"right",sortNum:7,hasReadOnly:false,hidden:false,width:200,listeners:me.createComboListeners()},Ext.create("Ext.zhifangux.DateField",{editable:false,format:"Y-m-d",type:"datefield",itemId:"HREmployee_Birthday",name:"HREmployee_Birthday",labelWidth:60,height:22,x:5,y:220,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"出生日期",labelAlign:"right",sortNum:8,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()}),{xtype:"textfield",type:"textfield",itemId:"HREmployee_UseCode",name:"HREmployee_UseCode",labelWidth:60,height:22,x:210,y:12,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"代码",labelAlign:"right",sortNum:9,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"combobox",hasButton:true,mode:"local",editable:false,displayField:"HRDept_CName",valueField:"HRDept_Id",store:new Ext.data.Store({fields:["HRDept_CName","HRDept_Id","HRDept_DataTimeStamp"],pageSize:1e3,proxy:{type:"ajax",async:false,url:getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchHRDeptByHQL?isPlanish=true&fields=HRDept_CName,HRDept_Id,HRDept_DataTimeStamp",reader:{type:"json",root:"list"},extractResponseData:me.changeStoreData},autoLoad:false}),DataTimeStampField:"MEPTOrderForm_HRDept_DataTimeStamp",type:"datacombobox",itemId:"HREmployee_HRDept_Id",name:"HREmployee_HRDept_Id",labelWidth:60,height:22,x:210,y:38,readOnly:true,labelStyle:"font-style:normal",fieldLabel:"部门",labelAlign:"right",sortNum:10,hasReadOnly:true,hidden:false,width:177,listeners:me.createBasicListeners()},{xtype:"button",width:22,height:22,itemId:"HREmployeeHRDeptId.FunctionBtn",name:"HREmployeeHRDeptId.FunctionBtn",disabled:true,x:385,y:38,boundField:"HREmployee_HRDept_Id",appComID:"5326294945188498462",iconCls:"build-button-configuration-blue",margin:"0 0 0 2",handler:function(com){me.showFormWin("add",-1,null)}},{xtype:"combobox",editable:true,typeAhead:true,queryMode:"local",displayField:"HRPosition_CName",valueField:"HRPosition_Id",DataTimeStampField:"HREmployee_HRPosition_DataTimeStamp",store:new Ext.data.Store({fields:["HRPosition_CName","HRPosition_Id","HRPosition_DataTimeStamp"],pageSize:1e3,proxy:{type:"ajax",async:false,url:getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchHRPositionByHQL?isPlanish=true&fields=HRPosition_CName,HRPosition_Id,HRPosition_DataTimeStamp",reader:{type:"json",root:"list"},extractResponseData:me.changeStoreData},autoLoad:false}),type:"combobox",itemId:"HREmployee_HRPosition_Id",name:"HREmployee_HRPosition_Id",labelWidth:60,height:22,x:210,y:64,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"职位",labelAlign:"right",sortNum:12,hasReadOnly:false,hidden:false,width:200,listeners:me.createComboListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_JobDuty",name:"HREmployee_JobDuty",labelWidth:60,height:22,x:210,y:90,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"工作职责",labelAlign:"right",sortNum:13,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"combobox",hasButton:false,mode:"local",editable:false,displayField:"text",valueField:"value",store:new Ext.data.SimpleStore({fields:["value","text"],data:[["1","是"],["0","否"]]}),type:"datacombobox",itemId:"HREmployee_IsEnabled",name:"HREmployee_IsEnabled",labelWidth:60,height:22,x:210,y:116,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"在职",labelAlign:"right",sortNum:14,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_MobileTel",name:"HREmployee_MobileTel",labelWidth:60,height:22,x:210,y:142,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"手机号码",labelAlign:"right",sortNum:15,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_OfficeTel",name:"HREmployee_OfficeTel",labelWidth:60,height:22,x:210,y:168,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"办公电话",labelAlign:"right",sortNum:16,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_ExtTel",name:"HREmployee_ExtTel",labelWidth:60,height:22,x:210,y:194,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"分机",labelAlign:"right",sortNum:17,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_Email",name:"HREmployee_Email",labelWidth:60,height:22,x:210,y:220,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"Email",labelAlign:"right",sortNum:18,hasReadOnly:false,hidden:false,width:200,listeners:me.createBasicListeners()},{xtype:"textarea",type:"textareafield",itemId:"HREmployee_Comment",name:"HREmployee_Comment",labelWidth:60,height:44,x:5,y:246,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"描述",labelAlign:"right",sortNum:19,hasReadOnly:false,hidden:false,width:405,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_LabID",name:"HREmployee_LabID",labelWidth:60,height:22,x:5,y:186,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"实验室ID",labelAlign:"right",sortNum:20,hasReadOnly:false,hidden:true,width:160,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_Id",name:"HREmployee_Id",labelWidth:60,height:22,x:210,y:187,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"主键ID",labelAlign:"right",sortNum:21,hasReadOnly:false,hidden:true,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_HRDept_DataTimeStamp",name:"HREmployee_HRDept_DataTimeStamp",labelWidth:60,height:22,x:5,y:187,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"部门时间戳",labelAlign:"right",sortNum:22,hasReadOnly:false,hidden:true,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_HRPosition_DataTimeStamp",name:"HREmployee_HRPosition_DataTimeStamp",labelWidth:60,height:22,x:5,y:0,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"时间戳",labelAlign:"right",sortNum:23,hasReadOnly:false,hidden:true,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_BSex_DataTimeStamp",name:"HREmployee_BSex_DataTimeStamp",labelWidth:60,height:22,x:210,y:117,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"时间戳",labelAlign:"right",sortNum:24,hasReadOnly:false,hidden:true,width:200,listeners:me.createBasicListeners()},{xtype:"textfield",type:"textfield",itemId:"HREmployee_DataTimeStamp",name:"HREmployee_DataTimeStamp",labelWidth:60,height:22,x:210,y:5,readOnly:false,labelStyle:"font-style:normal",fieldLabel:"时间戳",labelAlign:"right",sortNum:25,hasReadOnly:false,hidden:true,width:200,listeners:me.createBasicListeners()}];me.dockedItems=[{xtype:"toolbar",dock:"bottom",border:false,itemId:"bottomtoolbar",items:["->",{xtype:"button",text:"保存",iconCls:"build-button-save",handler:function(but){me.submit(but)}},{xtype:"button",text:"重置",iconCls:"build-button-refresh",handler:function(but){me.getForm().reset()}}]}];me.changeConfig();me.callParent(arguments)},showFormWin:function(type,id,record){Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.zhifangux.BasicTreePanel",getRootPath()+"/ui/zhifangux/BasicTreePanel.js");Ext.Loader.setPath("Ext.manage.emprolemodule.deptcomTree",getRootPath()+"/ui/manage/class/emprolemodule/deptcomTree.js");var me=this;var maxHeight=document.body.clientHeight*.98;var maxWidth=document.body.clientWidth*.98;var panelParams={type:type,maxWidth:maxWidth,width:280,height:300,dataId:id,title:"部门",selectionRecord:record,modal:true,floating:true,closable:true,resizable:true,draggable:true};var panel=Ext.create("Ext.manage.emprolemodule.deptcomTree",panelParams);if(panel.height>maxHeight){panel.height=maxHeight}panel.show();panel.on({saveClick:function(){panel.close();me.load(true);me.fireEvent("saveClick")},itemdblclick:function(view,record,tem,index,e,eOpts){var id=record.get("tid");me.getBSampleType(id);var HRDept=me.getComponent("HREmployee_HRDept_Id");HRDept.setValue(id);panel.close()}});if(type=="add"){me.fireEvent("afterOpenAddWin",panel)}else if(type=="edit"){me.fireEvent("afterOpenEditWin",panel)}else if(type=="show"){me.fireEvent("afterOpenShowWin",panel)}},getBSampleType:function(id){var me=this;if(id==null||id==""){return}else{var url=getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchHRDeptByHQL?isPlanish=true&fields=HRDept_DataTimeStamp&where=hrdept.Id="+id;var callback=function(responseText){var result=Ext.JSON.decode(responseText);if(result.success){if(result.ResultDataValue&&result.ResultDataValue!=""){var ResultDataValue=Ext.JSON.decode(result.ResultDataValue);var DataTimeStamp=ResultDataValue.list[0].HRDept_DataTimeStamp;var HRDept=me.getComponent("HREmployee_HRDept_Id");HRDept.setValue(id);var BSampleTypeDataTimeStamp=me.getComponent("HREmployee_HRDept_DataTimeStamp");BSampleTypeDataTimeStamp.setValue(DataTimeStamp)}}};getToServer(url,callback)}}});
var Shell=Shell||{};Shell.util=Shell.util||{};Shell.util.Path={rootPath:"",uiPath:"",imgPath:"",init:function(){this.rootPath=this.getRootPath();this.uiPath=this.rootPath+"/webapp/ui";this.imgPath=this.rootPath+"/Img"},getRootPath:function(){var href=window.document.location.href;var pathname=window.document.location.pathname;var pos=href.indexOf(pathname);var localhostPaht=href.substring(0,pos);var projectName=pathname.substring(0,pathname.substr(1).indexOf("/")+1);return(localhostPaht+projectName)}};Shell.util.Path.init();Shell.util.Event={touch:"touchend",delay:function(fun,scope,delayTime){if(Shell.util.typeOf(fun)!="function"){console.log("Shell.util.Event.delay方法参数错误:fun参数不是function!");return}var me=scope||this,delayTime=delayTime||300;me.etime=new Date().getTime();if(me.etime-me.stime<delayTime&&me.waitAction){clearTimeout(me.waitAction)}me.waitAction=setTimeout(fun,delayTime);me.stime=new Date().getTime()}};Shell.util.Isvalid={isCellPhoneNo:function(value){if(!value||value.length!=11){return false}var filter=/^1[3|5|8][0-9]\d{4,8}$/;return filter.test(value)},isIdCardNo:function(value){var filter=/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/;return filter.test(value)}};Shell.util.UI={pattern:/{(.+?)}/g,grid:{createGrid:function(config){var config=config||{},rows=this.createRows(config.data,config.rowModel,config.isMultiObject),divs=[],html="";if(rows){divs.push(rows);if(!config.hideLoadMore){divs.push('<div id="'+config.id+'_load_more" class="grid_load_more"><span>加载更多</span></div>')}}else{divs.push("没有查到记录")}html=divs.join("");if(config.id){html='<div id="'+config.id+'">'+html+"</div>"}return divs.join("")},createRows:function(data,rowModel,isMultiObject){var rowModel=rowModel||"",len=data.length,divs=[];if(isMultiObject){for(var i=0;i<len;i++){divs.push(this.createRowByMultiObject(data[i],rowModel))}}else{for(var i=0;i<len;i++){divs.push(this.createRow(data[i],rowModel))}}return divs.join("")},createRow:function(info,rowModel,isMultiObject){if(typeof(rowModel)=="function"){return rowModel(info)}var arr=rowModel.match(Shell.util.UI.pattern)||[],len=arr.length,value=rowModel;for(var i=0;i<len;i++){value=value.replace(eval("/"+arr[i]+"/g"),(info[arr[i].slice(1,-1)]||""))}return value},createRowByMultiObject:function(info,rowModel){if(typeof(rowModel)=="function"){return rowModel(info)}var arr=rowModel.match(Shell.util.UI.pattern),len=arr.length,value=rowModel;for(var i=0;i<len;i++){value=value.replace(eval("/"+arr[i]+"/g"),this.getMultiObjectValue(arr[i].slice(1,-1)))}return value},getMultiObjectValue:function(obj,keyStr){var arr=arr[i].split("."),len=arr.length,value=obj;for(var j=0;j<len;j++){value=value[arr[j]]}return value||""}}};Shell.util.Server={resultParams:{success:"success",msg:"ErrorInfo",value:"ResultDataValue"},ajax:function(config,callback){var con={type:"get",dataType:"json",contentType:"application/json; charset=utf-8",async:true};for(var i in config){con[i]=config[i]}if(!con.success){con.success=function(data,textStatus){var msg=data[Shell.util.Server.resultParams.msg],value=data[Shell.util.Server.resultParams.value];data.msg=(!data.success&&msg&&!config.showError)?"服务器出错了 ":msg;if(value&&typeof(value)==="string"){if(isNaN(value)){value=eval("("+value+")")}else{value=value+""}}data.value=value;callback(data)}}if(!con.error){con.error=function(XMLHttpRequest,textStatus,errorThrown){callback({success:false,msg:Shell.util.Server.getMsgByStatus(XMLHttpRequest.status)})}}con.headers=con.headers||{};con.headers.Type="503DC7557EB732E2E9ACBC1F4DE5455B";return $.ajax(con)},getMsgByStatus:function(status){var msg="";switch(status){case 404:msg="地球上找不到这个地址";break;case 500:msg="服务器出错了";break;default:msg="未定义错误："+status;break}return msg}};Shell.util.Cookie={mapping:{"openId":"100001","userId":"100002",},getCookie:function(name){var nameT=Shell.util.Cookie.mapping[name]||name,reg=new RegExp("(^| )"+nameT+"=([^;]*)(;|$)"),arr=document.cookie.match(reg);if(arr){return unescape(decodeURI(arr[2]).replace(/\+/g,"%20"))}return null},setCookie:function(name,value){var days=30,exp=new Date();exp.setTime(exp.getTime()+days*24*60*60*1000);document.cookie=name+"="+escape(value)+";expires="+exp.toGMTString()},delCookie:function(name){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=this.getCookie(name);if(cval!=null){document.cookie=name+"="+cval+";expires="+exp.toGMTString()}}};Shell.util.getRequestParams=function(toUpperCase){var url=location.search;if(url.indexOf("?")==-1){return{}}var str=url.substr(1),strs=str.split("&"),len=strs.length,params={};for(var i=0;i<len;i++){var arr=strs[i].split("=");if(toUpperCase){arr[0]=arr[0].toLocaleUpperCase()}params[arr[0]]=decodeURI(arr[1])}return params};Shell.util.typeOf=function(value){var type,typeToString;if(value===null){return"null"}type=typeof value;if(type==="undefined"||type==="string"||type==="number"||type==="boolean"){return type}typeToString=Object.prototype.toString.call(value);
switch(typeToString){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}if(type==="function"){return"function"}if(type==="object"){if(value.nodeType!==undefined){if(value.nodeType===3){return(/\S/).test(value.nodeValue)?"textnode":"whitespace"}else{return"element"}}return"object"}window.console.log("无法确定指定的值的类型,这最有可能是一个BUG!该值是:"+value)};Shell.util.JSON={decodeErrorInfo:"错误!你正在解码一个无效的JSON字符串",encodeMark:'"',decode:function(json,safe){try{return Shell.util.JSON.doDecode(json)}catch(e){if(safe===true){return null}var errorInfo="Shell.util.JSON.decode "+this.decodeErrorInfo+":"+json;window.console.log(errorInfo)}},encode:function(obj,mark){var bo=(mark=='"'||mark=="'");if(bo){this.encodeMarkCopy=this.encodeMark;this.encodeMark=mark}var str=this.encodeValue(obj);if(bo){this.encodeMark=this.encodeMarkCopy}return str},encodeKey:function(value){return this.encodeMark+value+this.encodeMark},encodeArray:function(o){var a=["[",""];var length=o.length;for(var i=0;i<length;i++){a.push(this.encodeValue(o[i]),",")}a[a.length-1]="]";return a.join("")},encodeObj:function(o){var a=["{",""];for(var i in o){a.push(this.encodeKey(i),":",this.encodeValue(o[i]),",")}a[a.length-1]="}";return a.join("")},encodeStr:function(str){return str.replace(/\\/g,"\\\\").replace(eval("/"+this.encodeMark+"/g"),"\\"+this.encodeMark)},encodeValue:function(value){var type=Shell.util.typeOf(value);if(type==="null"||type==="undefined"){return"null"}else{if(type==="number"||type==="boolean"){return value+""}else{if(type==="string"){return this.encodeMark+this.encodeStr(value)+this.encodeMark}else{if(type==="array"){return this.encodeArray(value)}else{if(type==="object"){return this.encodeObj(value)}}}}}},doDecode:function(json){return eval("("+json+")")}};
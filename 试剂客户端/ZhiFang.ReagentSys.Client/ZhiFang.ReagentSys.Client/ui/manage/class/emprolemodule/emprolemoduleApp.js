Ext.ns("Ext.manage.emprolemodule");Ext.define("Ext.manage.emprolemodule.emprolemoduleApp",{extend:"Ext.panel.Panel",alias:"widget.emprolemoduleApp",title:"员工与账号",header:false,border:false,typehql:0,layout:"border",comNum:0,iscomload:false,empId:"",accountId:"",allUserInfo:"",Fields:"RBACUser_Id,RBACUser_UseCode,RBACUser_Account,RBACUser_PWD,RBACUser_EnMPwd,RBACUser_PwdExprd,RBACUser_HREmployee_Id,RBACUser_HREmployee_DataTimeStamp,"+"RBACUser_AccExprd,RBACUser_AccLock,RBACUser_AuUnlock,RBACUser_LoginTime,RBACUser_AccBeginTime,RBACUser_AccEndTime",editDataServerUrl:"RBACService.svc/RBAC_UDTO_UpdateRBACUserByField",resetPasswordUrl:getRootPath()+"/RBACService.svc/RBAC_RJ_ResetAccountPassword",afterRender:function(){var me=this;me.callParent(arguments);me.initLink();var deptTree=me.getComponent("deptTree");deptTree.getSelectionModel().select(0);if(Ext.typeOf(me.callback)=="function"){me.callback(me)}},initComponent:function(){var me=this;me.bodyPadding=2;me.items=me.createItems();me.callParent(arguments)},comloadDatas:function(){var me=this;if(me.iscomload==false){var centerPanel=me.getComponent("centerPanel");var northPanel=centerPanel.getComponent("northPanel");var eastTab=northPanel.getComponent("eastTab");var employeeForm=eastTab.getComponent("employeeForm");var BSex=employeeForm.getComponent("HREmployee_BSex_Id");BSex.store.load();var HRDept=employeeForm.getComponent("HREmployee_HRDept_Id");HRDept.store.load();var HRPosition=employeeForm.getComponent("HREmployee_HRPosition_Id");HRPosition.store.load();me.iscomload=true}},initLink:function(){var me=this;var deptTree=me.getComponent("deptTree");var centerPanel=me.getComponent("centerPanel");var northPanel=centerPanel.getComponent("northPanel");var employeeList=northPanel.getComponent("employeeList");var eastTab=northPanel.getComponent("eastTab");var employeeForm=eastTab.getComponent("employeeForm");var accountForm=eastTab.getComponent("accountForm");var rolePanel=centerPanel.getComponent("rolePanel");var selectroleList=rolePanel.getComponent("selectroleList");var rolemoduleTree=rolePanel.getComponent("rolemoduleTree");var btnAdd=accountForm.getComponent("btnAdd");var btnUse=accountForm.getComponent("btnUse");var btnUpdate=accountForm.getComponent("btnUpdate");var btnPassWord=accountForm.getComponent("btnPassWord");var dep='';var employeeId="";deptTree.on({select:function(view,record){var Id=record.get("Id");dep=Id;var hql="id="+Id+"^";employeeList.load(hql)}});eastTab.on({tabchange:function(tabPanel,newCard,oldCard,eOpts){var oldItemId=null;if(oldCard!=null){oldItemId=oldCard.itemId}switch(newCard.itemId){case"employeeForm":comtab=employeeForm;empId=employeeId;if(employeeId!=me.empId){employeeForm.load(employeeId);me.empId=employeeId}break;case"accountForm":comtab=accountForm;if(employeeId!=me.accountId){me.accountDatas(accountForm,employeeId);me.accountId=employeeId}break;default:break}}});if(selectroleList.getStore().getCount()==0){selectroleList.load()}var comtab=eastTab.getActiveTab(eastTab.items.items[0]);employeeList.on({select:function(view,record){employeeId=record.get("HREmployee_Id");if(comtab==employeeForm){me.empId=employeeId;employeeForm.load(employeeId);me.comloadDatas()}else if(comtab==accountForm){me.accountId=employeeId;me.accountDatas(accountForm,employeeId)}rolemoduleTree.setTreeChecked([]);var callback=function(addData){selectroleList.setCheckedIds(addData)};var arr=me.getDataById(employeeId,callback);selectroleList.setCheckedIds(arr)},addClick:function(but){eastTab.setActiveTab("employeeForm");me.comloadDatas();employeeForm.isAdd();var HRDept=employeeForm.getComponent("HREmployee_HRDept_Id");if(dep!='0'){HRDept.setValue(dep);var depDataTimeStamp=employeeForm.getComponent('HREmployee_HRDept_DataTimeStamp');if(HRDept.getValue()!=null&&HRDept.getValue()!=''){depDataTimeStamp.setValue(HRDept.displayTplData[0]['HRDept_DataTimeStamp'])}else{HRDept.setValue('')}}},editClick:function(but){var records=employeeList.getSelectionModel().getSelection();if(records.length==1){var record=records[0];var id=record.get(employeeList.objectName+"_Id");employeeForm.isEdit(id)}else{Ext.Msg.alert("提示","请选择一条数据进行操作！")}}});employeeList.store.on({load:function(e,n){if(e.data.length==0){employeeForm.getForm().reset();accountForm.getForm().reset();btnAdd.disable(false);btnUse.disable(false);btnUpdate.disable(false);btnPassWord.disable(false);selectroleList.setCheckedIds([]);rolemoduleTree.setTreeChecked([])}}});var employeeNameL=employeeForm.getComponent("HREmployee_NameL");var employeeNameF=employeeForm.getComponent("HREmployee_NameF");employeeForm.on({saveClick:function(){employeeList.autoSelect=employeeForm.getForm().getValues()[employeeForm.objectName+"_Id"];employeeList.load(true)},beforeSave:function(){var HRDept=employeeForm.getComponent("HREmployee_HRDept_Id");if((HRDept.getValue()==null||HRDept.getValue()=='')&&dep=='0'){alertInfo("部门不能为空!");return false}if(employeeNameL){var txtValue=employeeNameL.getValue();if(txtValue==null||txtValue==""||txtValue==undefined){Ext.Msg.alert("提示","员工姓不能为空！");return false}}if(employeeNameF){var value=employeeNameF.getValue();if(value==null||value==""||value==undefined){Ext.Msg.alert("提示","员工名字不能为空！");return false}}}});selectroleList.on({select:function(view,record){var roleId=record.get("RBACRole_Id");var arrChecked=me.getroleDataById(roleId,null,"role");rolemoduleTree.selectdChecked=arrChecked;rolemoduleTree.setTreeChecked(arrChecked)}});selectroleList.on({okClick:function(){var store=selectroleList.getStore();var t="";store.each(function(record){if(record.get(selectroleList.keyColumn)==false&&record.dirty==true){t=1}});var data=selectroleList.getAllChanged();var ChangeRoleId="";var ChangeRoleValues=[];Ext.each(data,function(item,index,allItems){var RBACRole_Id=item.RBACRole_Id;ChangeRoleId=RBACRole_Id;ChangeRoleValues.push(RBACRole_Id)});var data=selectroleList.getAllChecked();var RoleId="";var RoleValues=[];Ext.each(data,function(item,index,allItems){var RBACRole_Id=item.RBACRole_Id;RoleId=RBACRole_Id;RoleValues.push(RBACRole_Id)});var emp=employeeId;var RoleId=Ext.encode(RoleValues);RoleId=RoleId.replace(/\[/g,"");RoleId=RoleId.replace(/\]/g,"");RoleId=RoleId.replace(/'/g,"");RoleId=RoleId.replace(/"/g,"");if(t==1){var flag=1;var RoleId=Ext.encode(ChangeRoleValues);RoleId=RoleId.replace(/\[/g,"");RoleId=RoleId.replace(/\]/g,"");RoleId=RoleId.replace(/'/g,"");RoleId=RoleId.replace(/"/g,"");if(emp==""||RoleId==""){return}else{me.Jurisdiction(emp,RoleId,flag);store.each(function(record){if(record.dirty==true){record.commit()}})}}else{if(emp==""||RoleId==""){return}else{var flag=0;me.Jurisdiction(emp,RoleId,flag);store.each(function(record){record.commit()})}}}});var employeeNameL=employeeForm.getComponent("HREmployee_NameL");var employeeNameF=employeeForm.getComponent("HREmployee_NameF");var hREmployeeCName=employeeForm.getComponent("HREmployee_CName");if(employeeNameL&&employeeNameL!=undefined){employeeNameL.on({change:function(field,newValue,oldValue,eOpts){if(employeeForm.isLoadingComplete==true&&(employeeForm.type=="edit"||employeeForm.type=="add")){var NameF=employeeNameF.getValue();if(NameF!=null&&NameF!=""){me.setPinYinZiTouValue(newValue+NameF);hREmployeeCName.setValue(newValue+NameF)}else{me.setPinYinZiTouValue(newValue);hREmployeeCName.setValue(newValue)}}}})}if(employeeNameF&&employeeNameF!=undefined){employeeNameF.on({change:function(field,newValue,oldValue,eOpts){if(employeeForm.isLoadingComplete==true&&(employeeForm.type=="edit"||employeeForm.type=="add")){var NameL=employeeNameL.getValue();if(NameL!=null&&NameL!=""){me.setPinYinZiTouValue(NameL+newValue);hREmployeeCName.setValue(NameL+newValue)}else{me.setPinYinZiTouValue(newValue);hREmployeeCName.setValue(newValue)}}}})}accountForm.on({AfterOpenWinbtnUpdate:function(from){var id=me.allUserInfo["RBACUser_Id"];var hREmployeeid=me.allUserInfo["RBACUser_HREmployee_Id"];var txtHREmployeeid=from.getComponent("RBACUser_HREmployee_Id");var txtRBACUserAccount=from.getComponent("RBACUser_Account");var dateRBACUserAccBeginTime=from.getComponent("RBACUser_AccBeginTime");var dateRBACUserAccEndTime=from.getComponent("RBACUser_AccEndTime");txtHREmployeeid.setValue(hREmployeeid);var dtBegin=Ext.Date.format(new Date(me.allUserInfo["RBACUser_AccBeginTime"]),"Y-m-d");var dtEnd=Ext.Date.format(new Date(me.allUserInfo["RBACUser_AccEndTime"]),"Y-m-d");from.load(id);var frmparams=accountForm.getForm().getValues();var txtAccount=from.getComponent("txtAccount");var oldAccount=frmparams["RBACUser_Account"];txtAccount.setValue(oldAccount);if(me.allUserInfo["RBACUser_AccBeginTime"]!=""){dateRBACUserAccBeginTime.setValue(dtBegin)}else{var dtstar=Ext.Date.format(new Date(),"Y-m-d");dateRBACUserAccBeginTime.setValue(dtstar)}dateRBACUserAccEndTime.setValue(dtEnd);from.on({saveClick:function(){from.close();var paramsfrom=from.getForm().getValues();var HREmployeeIdkey="RBACUser_HREmployee_Id";var HREmployeeId=paramsfrom[HREmployeeIdkey];if(HREmployeeId!=""){employeeList.autoSelect=HREmployeeId;employeeList.load(true)}}})},AfterOpenWinbtnAdd:function(form){var records=employeeList.getSelectionModel().getSelection();var record=records[0];var ygfrm=form;var txtuserid=ygfrm.getComponent("RBACUser_HREmployee_Id");var txtHREmployeeDataTimeStam=ygfrm.getComponent("RBACUser_HREmployee_DataTimeStamp");if(record&&record!=""&&record!=undefined){var ygid=record.data[employeeList.objectName+"_Id"];var HREmployeeDataTimeStam=record.data["HREmployee_DataTimeStamp"];txtuserid.setValue(ygid);txtHREmployeeDataTimeStam.setValue(HREmployeeDataTimeStam)}form.on({saveClick:function(){form.close();var paramsfrom=form.getForm().getValues();var HREmployeeIdkey="RBACUser_HREmployee_Id";var HREmployeeId=paramsfrom[HREmployeeIdkey];if(HREmployeeId!=""){employeeList.autoSelect=HREmployeeId;employeeList.load(true)}}})}});var txtAccLock=accountForm.getComponent("RBACUser_AccLock");btnUse.on({click:function(but,e,eOpts){var boolAccLock="";if(but.getText()=="账号停用"){but.setText("账号启用");boolAccLock=true;txtAccLock.setValue(true)}else{but.setText("账号停用");boolAccLock=false;txtAccLock.setValue(false)}var objdata={RBACUser_Id:me.allUserInfo["RBACUser_Id"],RBACUser_AccLock:boolAccLock};me.updateUserInfo(objdata,me.editDataServerUrl,0)}});btnPassWord.on({click:function(but,e,eOpts){var userInfodata=me.allUserInfo;var userId=userInfodata["RBACUser_Id"];if(userId&&userId!=""&&userId!=undefined){me.resetPassword(userId)}}});var toolbar=selectroleList.getComponent("toolbar").getComponent("buttonstoolbar");var update=toolbar.getComponent("refresh");update.on({click:function(){selectroleList.load(me.externalWhere)}});var searchText=toolbar.getComponent("searchText");searchText.on({specialkey:function(field,e){if(e.getKey()==Ext.EventObject.ENTER){var newValue=searchText.getValue();me.filterFn(selectroleList,newValue)}}});var searchbtn=toolbar.getComponent("searchbtn");searchbtn.on({click:function(){var newValue=searchText.getValue();me.filterFn(selectroleList,newValue)}})},Jurisdiction:function(empIdList,roleIdList,flag){var EmpIdList=getRootPath()+"/"+"RBACService.svc/RBAC_RJ_SetEmpRolesByEmpIdList";Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({url:EmpIdList+"?empIdList="+empIdList+"&"+"roleIdList="+roleIdList+"&"+"flag="+flag,method:"GET",timeout:5e3,success:function(response,opts){alertInfo("保存成功!")},failure:function(response,options){alertInfo("保存失败!")}})},updateUserInfo:function(strobj,myUpdataUrl,mark){var me=this;var myUrl="";if(myUpdataUrl!=""){myUrl=getRootPath()+"/"+myUpdataUrl}var values=strobj;var maxLength=0;for(var i in values){var arr=i.split("_");if(arr.length>maxLength){maxLength=arr.length}}var obj={};var addObj=function(key,num,value){var keyArr=key.split("_");var ob="obj";var objSJC="";for(var i=1;i<keyArr.length;i++){ob=ob+'["'+keyArr[i]+'"]';objSJC=keyArr[i];if(!eval(ob)){eval(ob+"={};")}}if(keyArr.length==num+1){if(objSJC=="DataTimeStamp"){value=value.split(",")}eval(ob+"=value;")}};for(var i=1;i<maxLength;i++){for(var j in values){var value=values[j];addObj(j,i,value)}}var field="";if(maxLength==2){for(var i in values){var keyArr=i.split("_");field=field+keyArr[1]+","}}if(field!=""){field=field.substring(0,field.length-1)}Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({async:false,url:myUrl,params:Ext.JSON.encode({entity:obj,fields:field}),method:"POST",timeout:7e3,success:function(response,opts){var result=Ext.JSON.decode(response.responseText);if(result.success){if(mark==0){alertInfo("保存成功！")}if(mark!=0){alertInfo("您的新密码为："+mark)}}else{alertError("保存应用组件失败！错误信息:"+result.ErrorInfo)}},failure:function(response,options){alertError("保存应用组件请求失败！")}})},resetPassword:function(accountId,callback){var me=this;Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({async:false,url:me.resetPasswordUrl+"?Id="+accountId,method:"GET",timeout:2e3,success:function(response,opts){var result=Ext.JSON.decode(response.responseText);var AccountPassword="";if(result.success){if(result.ResultDataValue&&result.ResultDataValue!=""){var ResultDataValue=Ext.JSON.decode(result.ResultDataValue);if(ResultDataValue.AccountPassword&&ResultDataValue.AccountPassword!=""){AccountPassword=ResultDataValue["AccountPassword"];alertInfo("您的新密码为："+AccountPassword)}}else{alertError("没有获取到应用信息！")}}else{alertError("提示","获取应用信息失败！错误信息:"+result.ErrorInfo)}},failure:function(response,options){alertError("获取应用信息请求失败！")}})},filterFn:function(list,value){var me=this,valtemp=value;var store=list.getStore();if(!valtemp){store.clearFilter();return}valtemp=String(value).trim().split(" ");store.filterBy(function(record,id){var data=record.data;var UseCode=record.data.RBACRole_UseCode;var CName=record.data.RBACRole_CName;var Comment=record.data.RBACRole_Comment;var dataarr={RBACRole_UseCode:UseCode,RBACRole_CName:CName,RBACRole_Comment:Comment};for(var p in dataarr){var porp=String(dataarr[p]);for(var i=0;i<valtemp.length;i++){var macther=valtemp[i];var macther2=Ext.escapeRe(macther);mathcer=new RegExp(macther2);if(mathcer.test(porp)){return true}}}return false})},setPinYinZiTouValue:function(newValue){var me=this;var centerPanel=me.getComponent("centerPanel");var northPanel=centerPanel.getComponent("northPanel");var eastTab=northPanel.getComponent("eastTab");var employeeForm=eastTab.getComponent("employeeForm");var hREmployeePinYinZiTou=employeeForm.getComponent("HREmployee_PinYinZiTou");var hREmployeeShortcode=employeeForm.getComponent("HREmployee_Shortcode");var changePinYinZiTou=function(newValue){if(newValue!=""&&newValue!=null){newValue=newValue.replace(/ /g,"")}if(hREmployeePinYinZiTou){hREmployeePinYinZiTou.setValue(newValue)}if(hREmployeeShortcode){hREmployeeShortcode.setValue(newValue)}};if(newValue!=""){getPinYinZiTouFromServer(newValue,changePinYinZiTou)}else{if(hREmployeePinYinZiTou){hREmployeePinYinZiTou.setValue("")}if(hREmployeeShortcode){hREmployeeShortcode.setValue("")}}},accountDatas:function(accountForm,Id){var me=this;var txtaccount=accountForm.getComponent("RBACUser_Account");var txtAccBeginTime=accountForm.getComponent("RBACUser_AccBeginTime");var txtAccEndTime=accountForm.getComponent("RBACUser_AccEndTime");var txtEnMPwd=accountForm.getComponent("RBACUser_EnMPwd");var txtAccLock=accountForm.getComponent("RBACUser_AccLock");var btnAdd=accountForm.getComponent("btnAdd");var btnUse=accountForm.getComponent("btnUse");var btnUpdate=accountForm.getComponent("btnUpdate");var btnPassWord=accountForm.getComponent("btnPassWord");var getUserInfoUrl=getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchRBACUserListByHQL?&isPlanish=true"+"&fields="+me.Fields+"&where="+"rbacuser.HREmployee.Id="+Id;var callback=function(accountInfo){if(accountInfo&&accountInfo!=""){var userInfo=accountInfo;me.allUserInfo=accountInfo;txtaccount.setValue(userInfo["RBACUser_Account"]);txtAccBeginTime.setValue(userInfo["RBACUser_AccBeginTime"]);txtAccEndTime.setValue(userInfo["RBACUser_AccEndTime"]);txtEnMPwd.setValue(userInfo["RBACUser_EnMPwd"]);txtAccLock.setValue(userInfo["RBACUser_AccLock"]);txtEnMPwd.setReadOnly(true);txtAccLock.setReadOnly(true);if(userInfo["RBACUser_Account"]!=""){btnAdd.disable(true);btnUse.enable(true);btnUpdate.enable(true);btnPassWord.enable(true);if(userInfo["RBACUser_AccLock"]=="true"){btnUse.setText("账号启用")}else{btnUse.setText("账号停用")}}else{btnAdd.enable(true);btnUse.disable(true);btnUpdate.disable(true);btnPassWord.disable(true)}}};me.getAccountInfo(getUserInfoUrl,callback)},getroleDataById:function(id,callback,type){var me=this;var arrData=[];var fields="RBACRoleModule_Id,RBACRoleModule_DataTimeStamp,RBACRoleModule_RBACModule_ParentID,RBACRoleModule_RBACModule_Id,RBACRoleModule_RBACModule_DataTimeStamp,RBACRoleModule_RBACRole_Id,RBACRoleModule_RBACRole_DataTimeStamp";var myUrl=getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchRBACRoleModuleByHQL"+"?isPlanish=true&fields="+fields;var w="";if(type=="role"){w="rbacrolemodule.RBACRole.Id="+id}else if(type=="module"){w="rbacrolemodule.RBACModule.Id="+id}w=me.encodeString(w);myUrl=myUrl+"&where="+w;Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({async:false,url:myUrl,method:"GET",timeout:2e3,success:function(response,opts){var result=Ext.JSON.decode(response.responseText);if(result.success){arrData=[];if(result.ResultDataValue&&result.ResultDataValue!=""){result.ResultDataValue=result.ResultDataValue.replace(/[\r\n]+/g,"<br/>");var ResultDataValue=Ext.JSON.decode(result.ResultDataValue);for(var i=0;i<ResultDataValue.count;i++){var RBACRoleModuleId=ResultDataValue.list[i]["RBACRoleModule_Id"];var RBACRoleModuleDataTimeStamp=ResultDataValue.list[i]["RBACRoleModule_DataTimeStamp"];var roleId=ResultDataValue.list[i]["RBACRoleModule_RBACRole_Id"];var roleDataTimeStamp=ResultDataValue.list[i]["RBACRoleModule_RBACRole_DataTimeStamp"];var moduleId=ResultDataValue.list[i]["RBACRoleModule_RBACModule_Id"];var moduleDataTimeStamp=ResultDataValue.list[i]["RBACRoleModule_RBACModule_DataTimeStamp"];var treeData={RBACRoleModuleId:RBACRoleModuleId,RBACRoleModuleDataTimeStamp:""+RBACRoleModuleDataTimeStamp,RBACRole_Id:roleId,roleDataTimeStamp:""+roleDataTimeStamp,moduleId:moduleId,moduleDataTimeStamp:""+moduleDataTimeStamp};arrData.push(treeData)}if(Ext.typeOf(callback)==="function"){callback(arrData)}}}},failure:function(response,options){arrData=[];Ext.Msg.alert("提示","获取数据信息请求失败！")}});return arrData},encodeString:function(value){var v=value||"";v=encodeURI(v);return v},getDataById:function(id,callback){var me=this;var arrData=[];var url=getRootPath()+"/RBACService.svc/RBAC_UDTO_SearchRoleByHREmpID"+"?id="+id+"&"+"fields=RBACRole_Id&isPlanish=true";Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({async:false,url:url,method:"GET",timeout:2e3,success:function(response,opts){var result=Ext.JSON.decode(response.responseText);if(result.success){arrData=[];if(result.ResultDataValue&&result.ResultDataValue!=""){result.ResultDataValue=result.ResultDataValue.replace(/[\r\n]+/g,"<br/>");var ResultDataValue=Ext.JSON.decode(result.ResultDataValue);for(var i=0;i<ResultDataValue.count;i++){var RBACRoleId=ResultDataValue.list[i].RBACRole_Id;var addData={RBACRole_Id:RBACRoleId};arrData.push(addData)}if(Ext.typeOf(callback)==="function"){callback(arrData)}}}},failure:function(response,options){arrData=[];Ext.Msg.alert("提示","获取应用信息请求失败！")}});return arrData},getAccountInfo:function(getUserInfoUrl,callback){var me=this;Ext.Ajax.defaultPostHeader="application/json";Ext.Ajax.request({async:false,url:getUserInfoUrl,method:"GET",timeout:2e3,success:function(response,opts){var result=Ext.JSON.decode(response.responseText);if(result.success){if(result.ResultDataValue&&result.ResultDataValue!=""){var ResultDataValue=Ext.JSON.decode(result.ResultDataValue);if(ResultDataValue.list&&ResultDataValue.list!=""&&ResultDataValue.list!=undefined){var addData={RBACUser_Account:ResultDataValue.list[0]["RBACUser_Account"],RBACUser_PWD:ResultDataValue.list[0]["RBACUser_PWD"],RBACUser_EnMPwd:ResultDataValue.list[0]["RBACUser_EnMPwd"],RBACUser_AccBeginTime:ResultDataValue.list[0]["RBACUser_AccBeginTime"],RBACUser_AccEndTime:ResultDataValue.list[0]["RBACUser_AccEndTime"],RBACUser_Id:ResultDataValue.list[0]["RBACUser_Id"],RBACUser_HREmployee_Id:ResultDataValue.list[0]["RBACUser_HREmployee_Id"],RBACUser_HREmployee_DataTimeStamp:ResultDataValue.list[0]["RBACUser_HREmployee_DataTimeStamp"],RBACUser_DataTimeStamp:ResultDataValue.list[0]["RBACUser_DataTimeStamp"],RBACUser_AccLock:ResultDataValue.list[0]["RBACUser_AccLock"],RBACUser_AuUnlock:ResultDataValue.list[0]["RBACUser_AuUnlock"]}}else{var addData={RBACUser_Account:"",RBACUser_PWD:"",RBACUser_EnMPwd:"",RBACUser_AccBeginTime:"",RBACUser_AccEndTime:"",RBACUser_Id:"",RBACUser_HREmployee_Id:"",RBACUser_HREmployee_DataTimeStamp:"",RBACUser_DataTimeStamp:"",RBACUser_AccLock:"",RBACUser_AuUnlock:""}}}else{var addData={RBACUser_Account:"",RBACUser_PWD:"",RBACUser_EnMPwd:"",RBACUser_AccBeginTime:"",RBACUser_AccEndTime:"",RBACUser_Id:"",RBACUser_HREmployee_Id:"",RBACUser_HREmployee_DataTimeStamp:"",RBACUser_DataTimeStamp:"",RBACUser_AccLock:"",RBACUser_AuUnlock:""}}if(Ext.typeOf(callback)=="function"){if(addData==""){alertError("没有获取到用户信息！")}else{callback(addData)}}}else{alertError("获取应用信息失败！错误信息:"+result.ErrorInfo)}},failure:function(response,options){alertError("获取应用信息请求失败！")}})},createItems:function(){var me=this;Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.zhifangux.DateField",getRootPath()+"/ui/zhifangux/DateField.js");Ext.Loader.setPath("Ext.zhifangux.FormPanel",getRootPath()+"/ui/zhifangux/FormPanel.js");Ext.Loader.setPath("Ext.zhifangux.GridPanel",getRootPath()+"/ui/zhifangux/GridPanel.js");Ext.Loader.setPath("Ext.zhifangux.BasicTabPanel",getRootPath()+"/ui/zhifangux/BasicTabPanel.js");Ext.Loader.setPath("Ext.manage.emprolemodule.deptTree",getRootPath()+"/ui/manage/class/emprolemodule/deptTree.js");Ext.Loader.setPath("Ext.zhifangux.CheckList",getRootPath()+"/ui/zhifangux/CheckList.js");Ext.Loader.setPath("Ext.manage.emprolemodule.selectroleList",getRootPath()+"/ui/manage/class/emprolemodule/selectroleList.js");Ext.Loader.setPath("Ext.manage.emprolemodule.rolemoduleTree",getRootPath()+"/ui/manage/class/emprolemodule/rolemoduleTree.js");var deptTree=Ext.create("Ext.manage.emprolemodule.deptTree",{header:false,itemId:"deptTree",name:"deptTree",region:"west",width:280,split:true,collapsible:true,title:"部门",border:true});var employeeList=Ext.create("Ext.manage.emprolemodule.employeeList",{header:false,itemId:"employeeList",name:"employeeList",region:"center",split:true,collapsible:true,title:"员工列表",border:true});var employeeForm=Ext.create("Ext.manage.emprolemodule.employeeForm",{header:true,itemId:"employeeForm",name:"employeeForm",region:"center",title:"员工基本信息",border:true});var accountForm=Ext.create("Ext.manage.emprolemodule.accountForm",{header:true,itemId:"accountForm",name:"accountForm",region:"center",title:"员工账号",border:true});var eastTab=Ext.create("Ext.zhifangux.BasicTabPanel",{header:false,itemId:"eastTab",name:"eastTab",region:"east",width:440,split:true,collapsible:true,title:"部门",layout:"border",border:true,items:[employeeForm,accountForm]});var selectroleList=Ext.create("Ext.manage.emprolemodule.selectroleList",{header:true,itemId:"selectroleList",name:"selectroleList",region:"center",title:"授权",border:true});var rolemoduleTree=Ext.create("Ext.manage.emprolemodule.rolemoduleTree",{header:true,itemId:"rolemoduleTree",name:"rolemoduleTree",region:"east",width:520,split:true,title:"已授权的功能",border:true});var rolePanel=Ext.create("Ext.panel.Panel",{header:false,itemId:"rolePanel",name:"rolePanel",region:"center",layout:"border",split:true,title:"角色权限",border:false,items:[selectroleList,rolemoduleTree]});var northPanel=Ext.create("Ext.panel.Panel",{header:false,itemId:"northPanel",name:"northPanel",region:"north",split:true,height:350,title:"顶部区域",border:false,layout:"border",items:[employeeList,eastTab]});var centerPanel=Ext.create("Ext.panel.Panel",{header:false,itemId:"centerPanel",name:"centerPanel",region:"center",title:"中间区域",layout:"border",border:false,items:[northPanel,rolePanel]});var appInfos=[deptTree,centerPanel];return appInfos}});